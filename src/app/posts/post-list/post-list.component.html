<mat-spinner *ngIf="isLoading"></mat-spinner>
<div class="addPost_button_container">
  <a
    class="addPost"
    mat-stroked-button
    *ngIf="userIsAuth"
    routerLink="/create_post"
    ><mat-icon> mail_outline</mat-icon></a
  >
</div>
<div class="post_container" *ngIf="posts.length && !isLoading">
  <div class="post_card" *ngFor="let post of posts">
    <mat-card>
      <mat-card-subtitle>
        <div class="header">
          <div class="top_header">
            <div>
              <strong>{{ post.title }} </strong>
            </div>
            <div>Post√© le: &nbsp;{{ post.date }}</div>
          </div>
          <div class="bottom_header">Par: &nbsp;{{ post.creator_pseudo }}</div>
        </div>
      </mat-card-subtitle>
      <img mat-card-image [src]="post.image" [alt]="post.title" />
      <mat-card-content>
        <p>{{ post.content }}</p></mat-card-content
      >
      <mat-card-actions
        ><a
          *ngIf="userIsAuth && userId == post.creator_id"
          [routerLink]="['/edit_post', post.id]"
          mat-button
          color="primary"
          >Editer</a
        >
        <button
          *ngIf="userIsAuth && userId == post.creator_id"
          mat-button
          color="warn"
          (click)="onDelete(post.id)"
        >
          Supprimer
        </button></mat-card-actions
      >
      <mat-card-footer
        ><mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title> Commentaires </mat-panel-title>
          </mat-expansion-panel-header>
          <mat-card-actions>
            <a
              *ngIf="userIsAuth && !commentInput"
              mat-button
              color="primary"
              (click)="commentInput = true"
              >Commenter</a
            >
            <form
              *ngIf="commentInput"
              [formGroup]="form"
              (submit)="onSaveComment(post.id)"
            >
              <mat-form-field>
                <input
                  matInput
                  type="text"
                  formControlName="comment"
                  placeholder="Entrez votre commentaire"
                />
                <mat-error *ngIf="form.get('comment').invalid"
                  >Entrez un commentaire</mat-error
                >
              </mat-form-field>
              <button mat-raised-button color="primary" type="submit">
                Poster
              </button>
              <button mat-raised-button color="warn" type="submit" (click)="commentInput = false">
                  annuler
              </button>
            </form>
          </mat-card-actions>
          <div class="comments_container" *ngFor="let comment of post.comments">
            <p>{{comment.content}}</p>
          </div>
        </mat-expansion-panel>
      </mat-card-footer>
    </mat-card>
  </div>
</div>

<!-- <div class="post_container">
  <div class="post">
    <mat-accordion multi="true" *ngIf="posts.length && !isLoading">
      <mat-expansion-panel *ngFor="let post of posts">
        <mat-expansion-panel-header>
          <div class="header">
            <div class="top_header">
              <div>
                <strong>{{ post.creator_pseudo }} </strong>
              </div>
              <div>{{ post.date }}</div>
            </div>
            <div class="bottom_header">
              {{ post.title }}
            </div>
          </div>
        </mat-expansion-panel-header>
        <div class="post-image">
          <img [src]="post.image" [alt]="post.title" />
        </div>
        <p>{{ post.content }}</p>
        <mat-action-row>
          <a
            *ngIf="userIsAuth && userId == post.creator_id"
            [routerLink]="['/edit_post', post.id]"
            mat-button
            color="primary"
            >Edit</a
          >
          <button
            *ngIf="userIsAuth && userId == post.creator_id"
            mat-button
            color="warn"
            (click)="onDelete(post.id)"
          >
            Delete
          </button>
        </mat-action-row>
      </mat-expansion-panel>
    </mat-accordion>
    <mat-paginator
      *ngIf="posts.length > 0"
      [length]="totalPosts"
      [pageSize]="postsPerPage"
      [pageSizeOptions]="pageSizeOptions"
      (page)="onChangedPage($event)"
    ></mat-paginator>
  </div> -->
<!-- </div> -->
<p class="mat-body-1 info-text" *ngIf="!posts.length && !isLoading">
  Nothing posted yet
</p>
